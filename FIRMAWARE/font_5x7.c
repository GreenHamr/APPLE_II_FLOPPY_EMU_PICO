/*
 * Font 5x7 с поддръжка на ASCII и кирилица (CP1251)
 * Всеки символ е 5 байта ширина, 7 пиксела височина
 */

#include "font_5x7.h"
#include <stdbool.h>

// ASCII символи (32-126)
static const uint8_t font_ascii[][5] = {
    {0x00, 0x00, 0x00, 0x00, 0x00}, // 32: space
    {0x00, 0x00, 0x5F, 0x00, 0x00}, // 33: !
    {0x00, 0x07, 0x00, 0x07, 0x00}, // 34: "
    {0x14, 0x7F, 0x14, 0x7F, 0x14}, // 35: #
    {0x24, 0x2A, 0x7F, 0x2A, 0x12}, // 36: $
    {0x23, 0x13, 0x08, 0x64, 0x62}, // 37: %
    {0x36, 0x49, 0x55, 0x22, 0x50}, // 38: &
    {0x00, 0x05, 0x03, 0x00, 0x00}, // 39: '
    {0x00, 0x1C, 0x22, 0x41, 0x00}, // 40: (
    {0x00, 0x41, 0x22, 0x1C, 0x00}, // 41: )
    {0x14, 0x08, 0x3E, 0x08, 0x14}, // 42: *
    {0x08, 0x08, 0x3E, 0x08, 0x08}, // 43: +
    {0x00, 0x00, 0xA0, 0x60, 0x00}, // 44: ,
    {0x08, 0x08, 0x08, 0x08, 0x08}, // 45: -
    {0x00, 0x60, 0x60, 0x00, 0x00}, // 46: .
    {0x20, 0x10, 0x08, 0x04, 0x02}, // 47: /
    {0x3E, 0x51, 0x49, 0x45, 0x3E}, // 48: 0
    {0x00, 0x42, 0x7F, 0x40, 0x00}, // 49: 1
    {0x42, 0x61, 0x51, 0x49, 0x46}, // 50: 2
    {0x21, 0x41, 0x45, 0x4B, 0x31}, // 51: 3
    {0x18, 0x14, 0x12, 0x7F, 0x10}, // 52: 4
    {0x27, 0x45, 0x45, 0x45, 0x39}, // 53: 5
    {0x3C, 0x4A, 0x49, 0x49, 0x30}, // 54: 6
    {0x01, 0x71, 0x09, 0x05, 0x03}, // 55: 7
    {0x36, 0x49, 0x49, 0x49, 0x36}, // 56: 8
    {0x06, 0x49, 0x49, 0x29, 0x1E}, // 57: 9
    {0x00, 0x36, 0x36, 0x00, 0x00}, // 58: :
    {0x00, 0x56, 0x36, 0x00, 0x00}, // 59: ;
    {0x08, 0x14, 0x22, 0x41, 0x00}, // 60: <
    {0x14, 0x14, 0x14, 0x14, 0x14}, // 61: =
    {0x00, 0x41, 0x22, 0x14, 0x08}, // 62: >
    {0x02, 0x01, 0x51, 0x09, 0x06}, // 63: ?
    {0x32, 0x49, 0x59, 0x51, 0x3E}, // 64: @
    {0x7C, 0x12, 0x11, 0x12, 0x7C}, // 65: A
    {0x7F, 0x49, 0x49, 0x49, 0x36}, // 66: B
    {0x3E, 0x41, 0x41, 0x41, 0x22}, // 67: C
    {0x7F, 0x41, 0x41, 0x22, 0x1C}, // 68: D
    {0x7F, 0x49, 0x49, 0x49, 0x41}, // 69: E
    {0x7F, 0x09, 0x09, 0x09, 0x01}, // 70: F
    {0x3E, 0x41, 0x49, 0x49, 0x7A}, // 71: G
    {0x7F, 0x08, 0x08, 0x08, 0x7F}, // 72: H
    {0x00, 0x41, 0x7F, 0x41, 0x00}, // 73: I
    {0x20, 0x40, 0x41, 0x3F, 0x01}, // 74: J
    {0x7F, 0x08, 0x14, 0x22, 0x41}, // 75: K
    {0x7F, 0x40, 0x40, 0x40, 0x40}, // 76: L
    {0x7F, 0x02, 0x0C, 0x02, 0x7F}, // 77: M
    {0x7F, 0x04, 0x08, 0x10, 0x7F}, // 78: N
    {0x3E, 0x41, 0x41, 0x41, 0x3E}, // 79: O
    {0x7F, 0x09, 0x09, 0x09, 0x06}, // 80: P
    {0x3E, 0x41, 0x51, 0x21, 0x5E}, // 81: Q
    {0x7F, 0x09, 0x19, 0x29, 0x46}, // 82: R
    {0x46, 0x49, 0x49, 0x49, 0x31}, // 83: S
    {0x01, 0x01, 0x7F, 0x01, 0x01}, // 84: T
    {0x3F, 0x40, 0x40, 0x40, 0x3F}, // 85: U
    {0x1F, 0x20, 0x40, 0x20, 0x1F}, // 86: V
    {0x3F, 0x40, 0x38, 0x40, 0x3F}, // 87: W
    {0x63, 0x14, 0x08, 0x14, 0x63}, // 88: X
    {0x07, 0x08, 0x70, 0x08, 0x07}, // 89: Y
    {0x61, 0x51, 0x49, 0x45, 0x43}, // 90: Z
    {0x00, 0x7F, 0x41, 0x41, 0x00}, // 91: [
    {0x02, 0x04, 0x08, 0x10, 0x20}, // 92: backslash
    {0x00, 0x41, 0x41, 0x7F, 0x00}, // 93: ]
    {0x04, 0x02, 0x01, 0x02, 0x04}, // 94: ^
    {0x40, 0x40, 0x40, 0x40, 0x40}, // 95: _
    {0x00, 0x01, 0x02, 0x04, 0x00}, // 96: `
    {0x20, 0x54, 0x54, 0x54, 0x78}, // 97: a
    {0x7F, 0x48, 0x44, 0x44, 0x38}, // 98: b
    {0x38, 0x44, 0x44, 0x44, 0x20}, // 99: c
    {0x38, 0x44, 0x44, 0x48, 0x7F}, // 100: d
    {0x38, 0x54, 0x54, 0x54, 0x18}, // 101: e
    {0x08, 0x7E, 0x09, 0x01, 0x02}, // 102: f
    {0x18, 0xA4, 0xA4, 0xA4, 0x7C}, // 103: g
    {0x7F, 0x08, 0x04, 0x04, 0x78}, // 104: h
    {0x00, 0x44, 0x7D, 0x40, 0x00}, // 105: i
    {0x40, 0x80, 0x84, 0x7D, 0x00}, // 106: j
    {0x7F, 0x10, 0x28, 0x44, 0x00}, // 107: k
    {0x00, 0x41, 0x7F, 0x40, 0x00}, // 108: l
    {0x7C, 0x04, 0x18, 0x04, 0x78}, // 109: m
    {0x7C, 0x08, 0x04, 0x04, 0x78}, // 110: n
    {0x38, 0x44, 0x44, 0x44, 0x38}, // 111: o
    {0xFC, 0x24, 0x24, 0x24, 0x18}, // 112: p
    {0x18, 0x24, 0x24, 0x18, 0xFC}, // 113: q
    {0x7C, 0x08, 0x04, 0x04, 0x08}, // 114: r
    {0x48, 0x54, 0x54, 0x54, 0x20}, // 115: s
    {0x04, 0x3F, 0x44, 0x40, 0x20}, // 116: t
    {0x3C, 0x40, 0x40, 0x20, 0x7C}, // 117: u
    {0x1C, 0x20, 0x40, 0x20, 0x1C}, // 118: v
    {0x3C, 0x40, 0x30, 0x40, 0x3C}, // 119: w
    {0x44, 0x28, 0x10, 0x28, 0x44}, // 120: x
    {0x1C, 0xA0, 0xA0, 0xA0, 0x7C}, // 121: y
    {0x44, 0x64, 0x54, 0x4C, 0x44}, // 122: z
    {0x00, 0x08, 0x36, 0x41, 0x00}, // 123: {
    {0x00, 0x00, 0x7F, 0x00, 0x00}, // 124: |
    {0x00, 0x41, 0x36, 0x08, 0x00}, // 125: }
    {0x10, 0x08, 0x08, 0x10, 0x08}, // 126: ~
};

// Кирилски символи (CP1251: 0xC0-0xFF)
// А-Я (главни букви)
static const uint8_t font_cyrillic_upper[][5] = {
    {0x7C, 0x12, 0x11, 0x12, 0x7C}, // 0xC0: А
    {0x7F, 0x49, 0x49, 0x49, 0x36}, // 0xC1: Б
    {0x7F, 0x49, 0x49, 0x49, 0x36}, // 0xC2: В
    {0x7F, 0x01, 0x01, 0x01, 0x01}, // 0xC3: Г
    {0x60, 0x3E, 0x21, 0x3F, 0x60}, // 0xC4: Д
    {0x7F, 0x49, 0x49, 0x49, 0x41}, // 0xC5: Е
    {0x77, 0x08, 0x7F, 0x08, 0x77}, // 0xC6: Ж
    {0x22, 0x41, 0x49, 0x49, 0x36}, // 0xC7: З
    {0x7F, 0x08, 0x08, 0x08, 0x7F}, // 0xC8: И
    {0x7F, 0x09, 0x09, 0x09, 0x01}, // 0xC9: Й
    {0x7F, 0x08, 0x14, 0x22, 0x41}, // 0xCA: К
    {0x7F, 0x40, 0x40, 0x40, 0x40}, // 0xCB: Л
    {0x7F, 0x02, 0x0C, 0x02, 0x7F}, // 0xCC: М
    {0x7F, 0x04, 0x08, 0x10, 0x7F}, // 0xCD: Н
    {0x3E, 0x41, 0x41, 0x41, 0x3E}, // 0xCE: О
    {0x7F, 0x09, 0x09, 0x09, 0x06}, // 0xCF: П
    {0x3E, 0x41, 0x51, 0x21, 0x5E}, // 0xD0: Р
    {0x7F, 0x09, 0x19, 0x29, 0x46}, // 0xD1: С
    {0x46, 0x49, 0x49, 0x49, 0x31}, // 0xD2: Т
    {0x01, 0x01, 0x7F, 0x01, 0x01}, // 0xD3: У
    {0x27, 0x48, 0x48, 0x48, 0x3F}, // 0xD4: Ф
    {0x1C, 0x22, 0x7F, 0x22, 0x1C}, // 0xD5: Х
    {0x3F, 0x40, 0x38, 0x40, 0x3F}, // 0xD6: Ц
    {0x1F, 0x20, 0x40, 0x20, 0x1F}, // 0xD7: Ч
    {0x3F, 0x40, 0x40, 0x40, 0x3F}, // 0xD8: Ш
    {0x1F, 0x20, 0x40, 0x20, 0x1F}, // 0xD9: Щ
    {0x01, 0x01, 0x7F, 0x01, 0x01}, // 0xDA: Ъ
    {0x27, 0x48, 0x48, 0x48, 0x3F}, // 0xDB: Ы
    {0x07, 0x08, 0x70, 0x08, 0x07}, // 0xDC: Ь
    {0x61, 0x51, 0x49, 0x45, 0x43}, // 0xDD: Э
    {0x3F, 0x40, 0x40, 0x40, 0x3F}, // 0xDE: Ю
    {0x47, 0x48, 0x48, 0x48, 0x3F}, // 0xDF: Я
};

// а-я (малки букви)
static const uint8_t font_cyrillic_lower[][5] = {
    {0x20, 0x54, 0x54, 0x54, 0x78}, // 0xE0: а
    {0x3C, 0x4A, 0x4A, 0x4A, 0x30}, // 0xE1: б
    {0x7C, 0x54, 0x54, 0x54, 0x28}, // 0xE2: в
    {0x7C, 0x04, 0x04, 0x04, 0x04}, // 0xE3: г
    {0x60, 0x38, 0x24, 0x3C, 0x60}, // 0xE4: д
    {0x38, 0x54, 0x54, 0x54, 0x18}, // 0xE5: е
    {0x6C, 0x10, 0x7C, 0x10, 0x6C}, // 0xE6: ж
    {0x18, 0x24, 0x24, 0x24, 0x18}, // 0xE7: з
    {0x3C, 0x40, 0x40, 0x20, 0x7C}, // 0xE8: и
    {0x3C, 0x41, 0x41, 0x21, 0x7C}, // 0xE9: й
    {0x7C, 0x10, 0x28, 0x44, 0x00}, // 0xEA: к
    {0x40, 0x3C, 0x40, 0x40, 0x3C}, // 0xEB: л
    {0x7C, 0x08, 0x10, 0x08, 0x7C}, // 0xEC: м
    {0x7C, 0x10, 0x10, 0x10, 0x7C}, // 0xED: н
    {0x38, 0x44, 0x44, 0x44, 0x38}, // 0xEE: о
    {0x7C, 0x04, 0x04, 0x04, 0x7C}, // 0xEF: п
    {0x7C, 0x14, 0x14, 0x14, 0x08}, // 0xF0: р
    {0x38, 0x44, 0x44, 0x44, 0x38}, // 0xF1: с
    {0x04, 0x04, 0x7C, 0x04, 0x04}, // 0xF2: т
    {0x0C, 0x50, 0x50, 0x50, 0x3C}, // 0xF3: у
    {0x18, 0x24, 0x7C, 0x24, 0x18}, // 0xF4: ф
    {0x44, 0x28, 0x10, 0x28, 0x44}, // 0xF5: х
    {0x3C, 0x40, 0x30, 0x40, 0x3C}, // 0xF6: ц
    {0x0C, 0x50, 0x50, 0x50, 0x3C}, // 0xF7: ч
    {0x3C, 0x40, 0x40, 0x40, 0x3C}, // 0xF8: ш
    {0x1C, 0x20, 0x40, 0x20, 0x1C}, // 0xF9: щ
    {0x04, 0x04, 0x7C, 0x04, 0x04}, // 0xFA: ъ
    {0x1C, 0x20, 0x40, 0x20, 0x1C}, // 0xFB: ы
    {0x0C, 0x10, 0x10, 0x10, 0x7C}, // 0xFC: ь
    {0x44, 0x64, 0x54, 0x4C, 0x44}, // 0xFD: э
    {0x3C, 0x40, 0x30, 0x40, 0x3C}, // 0xFE: ю
    {0x1C, 0x20, 0x40, 0x20, 0x1C}, // 0xFF: я
};

const uint8_t* font_get_glyph(uint8_t ch) {
    // ASCII символи (32-126)
    if (ch >= 32 && ch <= 126) {
        return font_ascii[ch - 32];
    }
    
    // Кирилски главни букви (0xC0-0xDF)
    if (ch >= 0xC0 && ch <= 0xDF) {
        return font_cyrillic_upper[ch - 0xC0];
    }
    
    // Кирилски малки букви (0xE0-0xFF)
    if (ch >= 0xE0 && ch <= 0xFF) {
        return font_cyrillic_lower[ch - 0xE0];
    }
    
    // Неподдържан символ - връщаме '?'
    return font_ascii[63]; // '?'
}

bool font_is_supported(uint8_t ch) {
    return (ch >= 32 && ch <= 126) || (ch >= 0xC0 && ch <= 0xFF);
}

